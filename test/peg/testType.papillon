{-# LANGUAGE QuasiQuotes, TypeFamilies, UndecidableInstances #-}

import Text.Papillon
import Data.Char

main :: IO ()
main = do
	case dv_testType $ parse initialPos "3351559" of
		Right (r, _) -> print r
		Left (ParseError c m p _ _ _) -> putStrLn $ "error: " ++ show (c, m, p)
	case dv_testType $ parse initialPos "8351559" of
		Right (r, _) -> print r
		Left (ParseError c m p _ _ _) -> putStrLn $ "error: " ++ show (c, m, p)

single :: a -> [a]
single = (: [])

just :: a -> Maybe a
just = Just
nothing :: Maybe a
nothing = Nothing

isThree :: Int -> Bool
isThree = (== 3)

[papillon|

testType :: Maybe Int
	= 3:digit		{ Nothing }
	/ d:digit		{ Just d }
;
digit :: Int
	= d:[isDigit d]		{ read (single d) }
;

|]
