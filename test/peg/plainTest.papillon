{-# LANGUAGE QuasiQuotes, TypeFamilies #-}

import Text.Papillon
import Data.Char

main :: IO ()
main = do
	case runError $ str $ parse "Hello, world" of
		Right (r, _) -> print r
		Left _ -> putStrLn "parse error"
	case runError $ str $ parse "hellOW, world" of
		Right (r, _) -> print r
		Left _ -> putStrLn "parse error"

type Hoge = Either (String, String) (Either (String, String) ())

[papillon|

uppers :: String
	= s:(c:[isUpper c] { c })+	{ s }
;
lowers <- [a-z]+;
str <- uppers lowers &',' / lowers uppers !',' / lowers;

|]
